<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <title>Neon Tetris – Neon Arcade</title>

    <!-- Motyw globalny -->
    <link rel="stylesheet" href="../../../css/theme.css" />
    <!-- Style gry -->
    <link rel="stylesheet" href="game.css" />

    <!-- Supabase – przed auth.js -->
    <script
      src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"
      defer
    ></script>

    <!-- Core -->
    <script src="../../../js/core/auth.js" defer></script>
    <script src="../../../js/core/auth-bar.js" defer></script>
    <script src="../../../js/core/progress.js" defer></script>
    <script src="../../../js/core/ui.js" defer></script>

    <!-- Logika gry -->
    <script src="game.js" defer></script>
  </head>
  <body class="arcade-body arcade-game-page">
    <!-- Pasek logowania -->
    <div
      data-arcade-auth-bar
      data-after-login="../../../arcade.html"
      data-after-guest="../../../arcade.html"
    ></div>

    <div class="shell">
      <div class="card game-root">
        <header class="game-header">
          <div>
            <h1 class="game-title">Neon Tetris</h1>
            <p class="game-subtitle">
              Układaj spadające klocki, twórz pełne linie i zdobywaj jak najwyższy
              wynik.
            </p>
          </div>

          <div class="score-panel">
            <div class="score-box">
              <span class="score-label">Wynik</span>
              <span id="score" class="score-value">0</span>
            </div>
            <div class="score-box">
              <span class="score-label">Rekord</span>
              <span id="best-score" class="score-value">0</span>
            </div>
            <div class="score-box">
              <span class="score-label">Gry</span>
              <span id="total-games" class="score-value">0</span>
            </div>
          </div>

          <div class="score-panel score-panel--buttons">
            <button id="new-game-btn" class="arcade-btn">Nowa gra</button>
            <button id="pause-btn" class="arcade-btn">Pauza</button>
            <button id="save-game-btn" class="arcade-btn">Zapisz</button>
            <button id="reset-record-btn" class="arcade-btn">
              Resetuj rekord
            </button>
          </div>
        </header>

        <main class="game-layout">
          <div class="game-main">
            <!-- Plansza -->
            <canvas id="game" width="240" height="480"></canvas>

            <!-- Sterowanie dotykowe (pokazywane tylko na urządzeniach dotykowych) -->
            <div class="touch-controls">
              <button id="btn-left" class="arcade-btn touch-btn">←</button>
              <button id="btn-right" class="arcade-btn touch-btn">→</button>
              <button id="btn-rotate" class="arcade-btn touch-btn">⟳</button>
              <button id="btn-soft" class="arcade-btn touch-btn">↓</button>
              <button id="btn-hard" class="arcade-btn touch-btn">⤓</button>
            </div>
          </div>

          <aside class="game-side">
            <div class="mini-stats">
              <div class="mini-stat">
                <span class="mini-label">Poziom</span>
                <span id="level" class="mini-value">1</span>
              </div>
              <div class="mini-stat">
                <span class="mini-label">Linie</span>
                <span id="lines" class="mini-value">0</span>
              </div>
            </div>

            <div class="controls-info">
              <div class="controls-title">Sterowanie</div>
              <div class="controls-keys">
                <b>← →</b> – ruch w poziomie<br />
                <b>↓</b> – miękki spadek<br />
                <b>↑</b> – obrót<br />
                <b>Spacja</b> – twardy spadek
              </div>
              <p class="controls-note">
                Po <b>Game Over</b> użyj przycisku <b>Nowa gra</b>, aby
                zrestartować.
              </p>
            </div>

            <div class="games-played-info">
              Rozegranych gier: <span id="games-played-info">0</span>
            </div>
          </aside>
        </main>

        <!-- Overlay końca gry -->
        <div id="game-over-overlay" class="overlay overlay--hidden">
          <div class="overlay-content">
            <h2>Koniec gry</h2>
            <p>Brak ruchów. Spróbuj jeszcze raz!</p>
            <button id="overlay-new-game-btn" class="arcade-btn">
              Nowa gra
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
